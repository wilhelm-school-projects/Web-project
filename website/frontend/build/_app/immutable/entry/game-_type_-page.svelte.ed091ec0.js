var I=Object.defineProperty;var S=(a,e,t)=>e in a?I(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var s=(a,e,t)=>(S(a,typeof e!="symbol"?e+"":e,t),t);import{M as w,S as N,i as k,s as M,k as u,q as b,a as B,l as m,m as v,r as H,h as g,c as A,n as d,b as O,D as p,H as f,I as J,o as $}from"../chunks/index.3fff79e7.js";import{p as D}from"../chunks/stores.5bcfeed6.js";import{r as L}from"../chunks/singletons.c136f306.js";const y=L("context-id-1");class E{constructor(e,t,n,i,r,o){s(this,"xPos");s(this,"yPos");s(this,"color","0,0,0");s(this,"alpha",1);s(this,"gamectx");s(this,"gameCanvas");this.gamectx=r,this.gameCanvas=o,this.xPos=e,this.yPos=t,this.color=n,this.alpha=i}draw(){}setColor(e){console.log("settings color: "+e)}hideMe(){console.log("Hiding me :(")}displayMe(){console.log("Displaing me :)")}}class G extends E{constructor(t,n,i,r,o,l,h,c){super(t,n,o,l,h,c);s(this,"radius");s(this,"endAngle",2);this.radius=i,this.endAngle=r,this.draw()}draw(){let[t,n,i]=this.color.split(",");this.gamectx.beginPath(),this.gamectx.fillStyle=`rgba(${t}, ${n}, ${i}, ${this.alpha})`,this.gamectx.arc(this.xPos,this.yPos,this.radius,0,Math.PI*this.endAngle),this.gamectx.closePath(),this.gamectx.fill()}}class R extends E{draw(){}}class T{constructor(e){s(this,"xPosMouse");s(this,"yPosMouse");s(this,"currentShape");s(this,"painting",!0);s(this,"stoppedPaintingJustNow",!1);s(this,"shapes");s(this,"drawInterval");s(this,"gamectx");s(this,"gameCanvas");if(this.gameCanvas=document.getElementById(e),this.gameCanvas==null)throw new Error("Game Canvas is null!");this.gamectx=this.gameCanvas.getContext("2d"),this.gameCanvas.height=window.innerHeight,this.gameCanvas.width=window.innerWidth,this.gameCanvas.addEventListener("mousemove",t=>{this.xPosMouse=t.clientX,this.yPosMouse=Math.round(t.clientY-this.gameCanvas.getBoundingClientRect().top)}),this.gameCanvas.addEventListener("mousedown",t=>{this.drawInterval=setInterval(()=>this.draw(t),50)}),this.gameCanvas.addEventListener("mouseup",()=>{clearInterval(this.drawInterval)}),this.gameCanvas.addEventListener("mouseout",()=>{clearInterval(this.drawInterval)}),this.shapes={rectangles:[],circles:[]},this.currentShape="circle"}draw(e){let t=.7;if(this.currentShape=="circle"){let n=10,i=2;this.shapes.circles.push(new G(this.xPosMouse,this.yPosMouse,n,i,"00, 00, 255",t,this.gamectx,this.gameCanvas))}else this.currentShape=="rectangle"&&this.shapes.rectangles.push(new R(this.xPosMouse,this.yPosMouse,"255,00,00",t,this.gamectx,this.gameCanvas))}async stringifyShapeInformation(){let e=Object.keys(this.shapes),t=[w(y),"shapes","endAngle","radius","xPos","yPos","color","alpha"].concat(e),n;n={[w(y)]:{}};for(const i of Object.keys(this.shapes))n[w(y)][i]=this.shapes[i];return JSON.stringify(n,t,2)}loadContext(e){console.log("loading context")}updateContext(e){console.log("updating context")}}class V{constructor(e,t){s(this,"painter");s(this,"Networker");this.painter=e,this.Networker=t,document.getElementById("button-Send-drawing-pane").addEventListener("click",async()=>{let r=await this.painter.stringifyShapeInformation();this.Networker.send(r)}),document.getElementById("button-Draw-drawing-pane").addEventListener("click",async()=>{let r=document.getElementById("canvas-wrapper");this.painter.painting?(r.style.pointerEvents="none",r.style.cursor="not-allowed",this.painter.stoppedPaintingJustNow=!0):(r.style.pointerEvents="",r.style.cursor=""),this.painter.painting=!this.painter.painting})}}class j{constructor(){}async send(e){return console.log("Skickar"),console.log(e),!0}async recieve(){return""}}class _{constructor(e){s(this,"gameCanvas");s(this,"gamectx");s(this,"painter");s(this,"settingsHandler");s(this,"Networker");this.painter=new T(e),this.Networker=new j,this.settingsHandler=new V(this.painter,this.Networker),setInterval(()=>this.transmit(),500),this.transmit()}async transmit(){if(this.painter.stoppedPaintingJustNow){this.painter.stoppedPaintingJustNow=!1;return}this.painter.painting}run(){}end(){}}class q extends _{run(){}end(){console.log("end")}}class W extends _{run(){console.log("run")}end(){console.log("end")}}function X(a){return console.log(a),a=="host"?new q("game-canvas"):new W("game-canvas")}function Y(a){let e,t,n,i,r,o,l;return{c(){e=u("main"),t=u("div"),n=u("h1"),i=b(a[0]),r=B(),o=u("div"),l=u("canvas"),this.h()},l(h){e=m(h,"MAIN",{class:!0});var c=v(e);t=m(c,"DIV",{class:!0});var x=v(t);n=m(x,"H1",{class:!0});var C=v(n);i=H(C,a[0]),C.forEach(g),x.forEach(g),r=A(c),o=m(c,"DIV",{id:!0,class:!0});var P=v(o);l=m(P,"CANVAS",{id:!0,class:!0}),v(l).forEach(g),P.forEach(g),c.forEach(g),this.h()},h(){d(n,"class","text-center col"),d(t,"class","row"),d(l,"id","game-canvas"),d(l,"class","svelte-12yie24"),d(o,"id","canvas-wrapper"),d(o,"class","row"),d(e,"class","game-container")},m(h,c){O(h,e,c),p(e,t),p(t,n),p(n,i),p(e,r),p(e,o),p(o,l)},p:f,i:f,o:f,d(h){h&&g(e)}}}function K(a,e,t){let n;J(a,D,o=>t(2,n=o));let i=n.url.href.split("/").at(n.url.href.split("/").length-1),r;return $(()=>{r=X(i),r.run(),r.end()}),[i]}class Z extends N{constructor(e){super(),k(this,e,K,Y,M,{})}}export{Z as default};
